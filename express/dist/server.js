(()=>{"use strict";var e={n:r=>{var n=r&&r.__esModule?()=>r.default:()=>r;return e.d(n,{a:n}),n},d:(r,n)=>{for(var o in n)e.o(n,o)&&!e.o(r,o)&&Object.defineProperty(r,o,{enumerable:!0,get:n[o]})},o:(e,r)=>Object.prototype.hasOwnProperty.call(e,r),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},r={};e.r(r);const n=require("express");var o=e.n(n);const t=require("cors");var s=e.n(t);const i=require("morgan");var c=e.n(i);const a=require("apollo-server-express"),u=a.gql`
  type Image {
    name: String!
  }

  type DynamoMovie {
    title:  String!
    tmdbId: String!
    id: String!
    mediaType: String!
  }

  type Query {
    getImages(page: Int!): [Image]
    getDynamoMovies: [DynamoMovie]
  }
`,p=require("fs");(0,require("dotenv").config)({path:"./.env"}),process.env.POSTGRES_HOST;const v=process.env.POSTGRES_USER,l=(process.env.POSTGRES_PORT,process.env.POSTGRES_PASSWORD),d=(process.env.POSTGRES_DB,process.env.DATABASE_URL_DEVELOPMENT,process.env.DATABASE_URL_PRODUCTION),y=(process.env.DATABASE_URL_TEST,process.env.WIDESCREEN_WALLPAPERS,process.env.WALLPAPER_PLAY,process.env.WALLHAVEN,process.env.ALPHA_CODERS,process.env.EXPRESS,process.env.IMAGES_DIR),f=(process.env.MOVIES_DIR,process.env.TV_DIR,process.env.MUSIC_DIR,process.env.TMDB_API_KEY,process.env.HTTP_PORT),S=process.env.API_GATEWAY;function g(e,r,n,o,t,s,i){try{var c=e[s](i),a=c.value}catch(e){return void n(e)}c.done?r(a):Promise.resolve(a).then(o,t)}const m={getImages:(P=function*(e,{page:r}){try{var n;return(yield p.promises.readdir(null!==(n=null==y?void 0:y.toString())&&void 0!==n?n:"")).slice(20*r-20,20*r)}catch(e){console.error(e)}},function(){var e=this,r=arguments;return new Promise((function(n,o){var t=P.apply(e,r);function s(e){g(t,n,o,s,i,"next",e)}function i(e){g(t,n,o,s,i,"throw",e)}s(void 0)}))})};var P;const _=require("axios"),E=e.n(_)().create({baseURL:S});function O(e,r,n,o,t,s,i){try{var c=e[s](i),a=c.value}catch(e){return void n(e)}c.done?r(a):Promise.resolve(a).then(o,t)}function h(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}const A={Query:function(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),o.forEach((function(r){h(e,r,n[r])}))}return e}({},m,{getDynamoMovies:function(e){return function(){var r=this,n=arguments;return new Promise((function(o,t){var s=e.apply(r,n);function i(e){O(s,o,t,i,c,"next",e)}function c(e){O(s,o,t,i,c,"throw",e)}i(void 0)}))}}((function*(){try{const{data:e}=yield E({method:"GET",url:"/movies"});return e}catch(e){console.error(e)}}))})},T=require("knex");var b=e.n(T);const R=require("path");var D=e.n(R);const I={client:"pg",connection:{connectionString:d,user:v,password:l},migrations:{directory:D().resolve(__dirname,"./postgres/migrations"),extension:"ts"},seeds:{directory:D().resolve(__dirname,"./postgres/seeds"),extension:"ts"}},M=b()(I);function w(e,r,n,o,t,s,i){try{var c=e[s](i),a=c.value}catch(e){return void n(e)}c.done?r(a):Promise.resolve(a).then(o,t)}function L(e){return function(){var r=this,n=arguments;return new Promise((function(o,t){var s=e.apply(r,n);function i(e){w(s,o,t,i,c,"next",e)}function c(e){w(s,o,t,i,c,"throw",e)}i(void 0)}))}}const q={origin:"*"};function x(){return(x=L((function*(){const e=o()(),r=new a.ApolloServer({typeDefs:u,resolvers:A,context:()=>({db:M()})});e.use(c()(":method :url :status :res[content-length] - :response-time ms")),e.use(s()(q)),yield r.start(),r.applyMiddleware({app:e,path:"/api/graphql"}),e.listen({port:f},(()=>console.log(`App is listening on Port ${f}`)))}))).apply(this,arguments)}try{!function(){x.apply(this,arguments)}()}catch(e){console.error(e)}var j=exports;for(var G in r)j[G]=r[G];r.__esModule&&Object.defineProperty(j,"__esModule",{value:!0})})();